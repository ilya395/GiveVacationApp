!function(e){function t(t){for(var a,l,c=t[0],i=t[1],u=t[2],f=0,m=[];f<c.length;f++)l=c[f],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&m.push(r[l][0]),r[l]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(s&&s(t);m.length;)m.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,c=1;c<n.length;c++){var i=n[c];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},r={0:0},o=[];function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var c=window.webpackJsonp=window.webpackJsonp||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;o.push([293,1]),n()}({170:function(e,t,n){e.exports={root:"_3mzvt2dfIcxezlBOA_zAyl","start-col":"_3BOOTK9MCLyWGkRfwokeSU",col:"_3jgevgdoAcNg41bS9Di1ok"}},211:function(e,t,n){e.exports={root:"_1Tsp9tDRxFDaCmH9rOQGnQ","inner-elem":"_2iThc5dqDVtQ9k1akJVwOr",start:"y9nOZJSfJPtqkI3MhfJq9",end:"_3fu-yG2kfRcor4IljHOnon"}},289:function(e,t,n){e.exports={"select-element":"_2ctkSYaW2EH_keCx5s1m3e"}},293:function(e,t,n){n(294),e.exports=n(627)},34:function(e,t,n){e.exports={"page-title":"_3SFFJOXbud1k2janVVLpfG",form:"_2ZCOB-XfI4r1DS0LU92GiB","form-field":"_191R7kZB47ncfKa-dfXSGS","form-field__select-wrap":"WxvaEylXGJJ-6JggBkv4H","select-label":"_3OGZzezyoVTM48ZqOqmGgP","select-element":"_332UtWNFZchEpcLkIhRWa","input-elem":"_5XGyOba1Eb395OX_VziUn","form-field__input-date-wrap":"_1ePDtYdnBVrUNZD6Q-xqSF","date-input":"_2uoUyIeUMAuzuFUys1tuk4","submit-button":"T5FespIgZ97wanDaisqtO","select-component":"_2qPLoP8uAavsn5Y8lqYt7d"}},46:function(e,t,n){e.exports={"page-title":"_2jDy73cdxRg-Iudg1deQfv","button-new-object":"_12QqcsRMtYgWEvHalIsuwr","button-new-object__text":"_2pzb4YgRDF6lSRTdecCDv3",wrap:"_3GIJehpypSDZhx454yqVJ",wrap__manage:"_18galqCmAJrrvT9-GzQd36",wrap__select:"_24ra3z2p7LchnuvKqHw57i",wrap__year:"_38v1ZvAIdWdpPO9A53ZEZA","one-row":"_1dDAuYKonLDsUDVf-kkDIP","one-row__number":"YHGLrO65hMGx5o8VEeM7S","one-row__elem":"_2NTEiRMdBmvKh47gjsJiQH","one-row__buttons":"_1qcwfV9tMQTp6T9XsDUFbh","one-row__redaction":"_3lwIgGf9OtNin9YJAqxfzB","one-row__delete":"_366yikAp2AnNIK4ot0XeXT"}},486:function(e,t,n){},487:function(e,t,n){},49:function(e,t,n){e.exports={"page-title":"_2-k3FYOPrLISgLXBykC8sN","button-new-object":"_3TW37yoBtHB-Bw4HQPwv3y","button-new-object__text":"_2wHhUmTv4QDY3t_MbYtPy8",wrap:"_1DNvf0QXOMJVX3cII7ND-D",wrap__manage:"_3ZPlpjT_ocRb7FIKf3mYYM",wrap__select:"_1U3SCqpegzboLEcTzNNDB2",wrap__year:"_3yu5OCTrHNuG-_vKR50DBI","one-row":"k4II8IW3WBuDV5J0kPFwh","one-row__number":"_2ApsrToSdo1tUgswG4kzsG","one-row__elem":"_7airtp7tUiymkRYapwa_","one-row__name_position":"_10vycUjJQLrs0e5KYUmrlJ","one-row__buttons_position":"_11vjfBbwB8tLp_Op12mHOF","one-row__buttons":"_1aYOD30kO2hPA1WEgE1BYZ","one-row__redaction":"iAPBMqWISb32d0qJo-oil","one-row__delete":"_3VwGWA_PqTZHGpNMonQD_n"}},51:function(e,t,n){e.exports={"page-title":"_2mExhhM5jAILzoiNju52Po",form:"nfFaYQxcDQPh72oufHiNU","form-field":"_1cadmoRwa6Zfg7osvTfz9n","form-field__select-wrap":"TKYqMSoCWoh0RxFGzjl9s","select-label":"_36a6_DyivUl6tB7_PZwGUT","select-element":"_3E7dPJGQTabkCd7x8wTJpK","form-field__input-date-wrap":"_3mkGR6c2mGtdNJ_6ZchWeN","date-input":"KlkYhcEf3Flk91ImRR5__","submit-button":"_1TCWZm2lwuQIWY1NLXdp59"}},542:function(e,t,n){},543:function(e,t,n){},60:function(e,t,n){e.exports={"page-title":"_38q-9poBQkyqGaWcx6-viG","button-new-object":"_2k2lpxZSN5otGYn3HmArxJ","button-new-object__text":"_2d4AEC2ESCS0z9G3UTNyYR",wrap:"_1eheVT3tBtToQ-CGA0WtpJ",wrap__manage:"_3b-ypER_K2igF4JPTktcla",wrap__select:"_2rKq9LNy6IkHI1qITHzsVk",wrap__year:"_3RTqoWOUq5m5pbMStf3oVR","one-row":"_2agi48okGSt1XZjahPPOZJ","one-row__number":"_2RCznjSWuPGOLYcyLY2XTZ","one-row__elem":"Pih9F-rb87ymQ3t-t6nSg","one-row__name_position":"_1ClEEGLlf9dNTMF41Ia456","one-row__buttons_position":"_2dgFWx4QP3w_xZrtC2EL7B","one-row__buttons":"_1EbMRE1YbeYC5Pl1nEOPIp","one-row__redaction":"_3mM2ks5Ols_nVOFWixhH9g","one-row__delete":"_3p6wK-zIbUVCOxg2NJ-ki7"}},622:function(e,t,n){},627:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),l=n(20),c=n.n(l),i=n(61),u=(n(486),n(40)),s=(n(487),n(628)),f=n(631),m=n(290),d=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(m.a,{type:"primary",danger:!0,onClick:e.logoutPlz},"Выйти"))},p=o.a.createContext(null),b=n(45),v=n(632);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=(y(a={home:{title:"Главная",url:"/"},users:{title:"Пользователи",url:"/users"},user:{title:"Пользователь",url:"/user/:id"}},"new-user",{title:"Пользователи",url:"/user/new-user"}),y(a,"vacations",{title:"Отпуска",url:"/vacations"}),y(a,"vacation",{title:"Отпуск",url:"/vacation/:id"}),y(a,"new-vacation",{title:"Новый отпуск",url:"/vacation/new-vacation"}),y(a,"departments",{title:"Отделы",url:"/departments"}),y(a,"department",{title:"Отдел",url:"/department/:id"}),y(a,"new-department",{title:"Новый отдел",url:"/department/new-department"}),a),g=o.a.createContext(null),h=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],w=99999,E=900,O=901;function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var D=function(){var e=Object(r.useContext)(g),t=(e.login,e.userData);console.log(Object(r.useContext)(g));var n=j(Object(r.useState)(E),2),a=n[0],l=n[1];return Object(r.useEffect)((function(){t&&l(t.role_id)}),[t]),o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a,{theme:"dark",mode:"horizontal"},o.a.createElement(v.a.Item,{key:"1"},o.a.createElement(b.c,{to:_.home.url},_.home.title)),a!==E?a!==O?o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a.Item,{key:"2"},o.a.createElement(b.c,{to:_.users.url},_.users.title)),o.a.createElement(v.a.Item,{key:"3"},o.a.createElement(b.c,{to:_.vacations.url},_.vacations.title)),o.a.createElement(v.a.Item,{key:"4"},o.a.createElement(b.c,{to:_.departments.url},_.departments.title))):o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a.Item,{key:"3"},o.a.createElement(b.c,{to:_.vacations.url},_.vacations.title))):o.a.createElement(o.a.Fragment,null)))};function N(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var A=s.a.Header,I=s.a.Content,x=s.a.Footer,F=(f.a.Title,function(e){var t=e.children,n=N(e,["children"]),a=Object(r.useContext)(p).auth,l=n.history;return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{className:"layout"},o.a.createElement(A,null,o.a.createElement("i",{style:{color:"rgba(255, 255, 255, 0.65)"}},"когданибудьздесьбудетлого"),o.a.createElement(D,null),o.a.createElement("div",null,o.a.createElement(d,{logoutPlz:function(){console.log("ок, logout"),a.signOut(),localStorage.removeItem("userId"),l.push("/auth")}}))),o.a.createElement(I,{style:{padding:"0 50px",overflow:"auto"}},o.a.createElement("div",{className:"site-layout-content"},t)),o.a.createElement(x,{style:{textAlign:"center"}},"Created by DVM-Group")))}),C=(n(542),n(630)),k=n(633),T=n(634),R=n(629),Y=(n(543),function(){return o.a.createElement("div",{className:"work-area preloader"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"preloader-wrapper big active"},o.a.createElement(T.b,{size:"middle"},o.a.createElement(R.a,{size:"large"})))))});function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var V={labelCol:{span:8},wrapperCol:{span:16}},L={wrapperCol:{offset:8,span:16}},G=function(e){var t=M(Object(r.useState)(!0),2),n=t[0],a=t[1];Object(r.useEffect)((function(){return a(!1)}),[]);var l=M(Object(r.useState)(null),2),c=l[0],i=l[1];Object(r.useEffect)((function(){var t=e.history;i(t)}),[e]);var u=M(Object(r.useState)(!1),2),s=u[0],f=u[1],d=Object(r.useContext)(p).signWithEmail;Object(r.useEffect)((function(){!0===s&&c.push("/")}),[s,c]);return n?o.a.createElement(Y,null):o.a.createElement("div",{className:"form-wrap"},o.a.createElement(C.a,P({},V,{name:"basic",initialValues:{remember:!0},onFinish:function(e){var t=e.email,n=e.password;d(t,n).then((function(e){console.log("Success!"),f(!0),localStorage.setItem("userId",e.user.uid),c.push("/")})).catch((function(){console.log("кто ты тварь?"),f(!1)}))},onFinishFailed:function(e){console.log("Failed:",e)},className:"form"}),o.a.createElement(C.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}]},o.a.createElement(k.a,null)),o.a.createElement(C.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},o.a.createElement(k.a.Password,null)),o.a.createElement(C.a.Item,L,o.a.createElement(m.a,{type:"primary",htmlType:"submit"},"Войти"))))};function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var z=function(e){var t=e.component,n=q(e,["component"]);return o.a.createElement(u.b,J({},n,{render:function(e){return localStorage.getItem("userId")?o.a.createElement(F,null,o.a.createElement(t,e)):o.a.createElement(u.a,{to:"/auth"})}}))},B=n(2),Z=n.n(B),W=n(88),H=n.n(W),Q=n(170),K=n.n(Q),X=n(211),$=n.n(X),ee=function(e){var t=e.data,n=(e.name,e.index,31);return t&&(n=new Date(t[0].year,t[0].monthNumber,0).getDate()),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Z()($.a.root)},null!=t?o.a.createElement("div",{className:Z()($.a["inner-elem"]),style:{left:"".concat((t[0].day-1)/(n-1)*100,"%"),right:"".concat(n===+t[1].day?0:(n-1-(+t[1].day-1))/(n-1)*100,"%")}}):o.a.createElement(o.a.Fragment,null)))},te=function(e){var t=e.name,n=(e.id,e.vacations);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Z()(K.a.root)},o.a.createElement("div",{className:Z()(K.a["start-col"])},t),h.map((function(e,a){var r=n.find((function(e){return+e[0].monthNumber==+a}));return o.a.createElement("div",{key:a,className:Z()(K.a.col)},o.a.createElement(ee,{data:r||null,name:t,index:+a}))}))))},ne=n(289),ae=n.n(ne);function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var le=function(e){var t=e.identificate,n=(e.title,e.defaultValue),a=e.handleFunction,l=e.data,c=re(Object(r.useState)(n),2),i=c[0],u=c[1];Object(r.useEffect)((function(){u(n)}),[n]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("select",{id:t,name:t,value:+i,onChange:function(e){a(+e.target.value),u(+e.target.value)},className:Z()(ae.a["select-element"])},l.map((function(e){return o.a.createElement("option",{key:e.id,value:+e.id},e.name)}))))};function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var se=function(e){var t=ie(Object(r.useState)([]),2),n=t[0],a=t[1],l=ie(Object(r.useState)([]),2),c=l[0],i=l[1],u=ie(Object(r.useState)([]),2),s=u[0],f=u[1],m=ie(Object(r.useState)([]),2),d=m[0],b=m[1],v=ie(Object(r.useState)(2021),2),y=(v[0],v[1],ie(Object(r.useState)(0),2)),_=y[0],j=y[1],S=ie(Object(r.useState)([]),2),D=S[0],N=S[1],A=ie(Object(r.useState)((new Date).getFullYear()),2),I=A[0],x=A[1],F=Object(r.useContext)(p),C=(F.getUsersRef,F.getDepartmentsRef,F.getVacationsRef,F.getYearsRef),k=Object(r.useContext)(g),T=k.userData,R=k.allUsersData,Y=k.allVacationsData,P=k.allDepartmentsData,M=ie(Object(r.useState)(E),2),U=M[0],V=M[1],L=ie(Object(r.useState)(0),2),G=L[0],J=L[1];Object(r.useEffect)((function(){C().once("value").then((function(e){return e.val()})).then((function(e){return N(e)})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за годами")}))}),[]),Object(r.useEffect)((function(){a(R)}),[R]),Object(r.useEffect)((function(){if(+U===E||+U===O&&P.length>0){var e=P.filter((function(e){return+e.id==+G}));e.length>0&&(i(e),j(e[0].id))}else{P.find((function(e){return e.id===w}))?(i(P),j(P[0].id)):(P.unshift({id:w,name:"Все"}),i(P),j(P[0].id))}}),[P,U,G]),Object(r.useEffect)((function(){f(Y)}),[Y]),Object(r.useEffect)((function(){var e=(_===w?n:n.filter((function(e){return+e.department_id==+_}))).map((function(e){var t=s.filter((function(t){return+t.user_id==+e.id&&new Date(+t.vacation_start).getFullYear()===I})),n=[];return t.forEach((function(e){var t=e.vacation_start,a=e.vacation_end;new Date(t).getMonth()===new Date(a).getMonth()?n.push([{type:"start",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(+e.vacation_start).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_start},{type:"end",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(+e.vacation_end).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end}]):(n.push([{type:"start",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(+e.vacation_start).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_start},{type:"end",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(new Date(+e.vacation_start).getFullYear(),new Date(+e.vacation_start).getMonth()+1,0).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_end}]),n.push([{type:"start",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(new Date(+e.vacation_end).getFullYear(),new Date(+e.vacation_end).getMonth(),1).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end},{type:"end",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(+e.vacation_end).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end}]))})),{name:"".concat(e.name," ").concat(e.surname),id:e.id,vacations:n}}));b(e)}),[n,s,c,I,_]),Object(r.useEffect)((function(){T&&(V(T.role_id),J(T.department_id))}),[T]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(H.a["page-title"])},"Расписание, дорогой(-ая)!"),o.a.createElement("div",{className:Z()(H.a.wrap__manage)},o.a.createElement("div",{className:Z()(H.a.wrap__year)},o.a.createElement(le,{identificate:"selectYear",title:"Выберите год",defaultValue:(new Date).getFullYear(),handleFunction:function(e){x(+e)},data:D})),o.a.createElement("div",{className:Z()(H.a.wrap__select)},o.a.createElement(le,{identificate:"selectDepartmentOnMainPage",title:"Выберите отдел",defaultValue:_,handleFunction:function(e){j(+e)},data:c}))),o.a.createElement("div",null,o.a.createElement("div",{className:Z()(H.a["content-title-block"])},o.a.createElement("div",{className:Z()(H.a["content-title-block__start-elem"])},"Пользователи"),h.map((function(e){return o.a.createElement("div",{key:e,className:Z()(H.a["content-title-block__elem"])},e)}))),o.a.createElement("div",{className:Z()(H.a["content-body-block"])},d.map((function(e){return o.a.createElement(te,ce({key:e.id},e))})))))},fe=n(49),me=n.n(fe);function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var be=function(e){var t=de(Object(r.useState)([]),2),n=t[0],a=t[1],l=de(Object(r.useState)([]),2),c=l[0],i=l[1],u=de(Object(r.useState)(0),2),s=u[0],f=u[1],m=de(Object(r.useState)([]),2),d=m[0],v=m[1],y=Object(r.useContext)(p),_=y.getUsersRef,g=y.getDepartmentsRef;Object(r.useEffect)((function(){_().once("value").then((function(e){return e.val()})).then((function(e){return a(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){g().once("value").then((function(e){return e.val()})).then((function(e){e.unshift({id:w,name:"Все"}),i(e),f(e[0].id)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){var e=s===w?n:n.filter((function(e){return+e.department_id==+s}));v(e)}),[s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(me.a["page-title"])},"Список пользователей"),o.a.createElement("div",{className:Z()(me.a.wrap)},o.a.createElement("div",{className:Z()(me.a["wrap__add-vacation"])},o.a.createElement(b.b,{to:"user/new-user",className:Z()(me.a["button-new-object"],me.a[".button-new-object__text"])},"Новый пользователь")),o.a.createElement("div",{className:Z()(me.a.wrap__manage)},o.a.createElement("div",{className:Z()(me.a.wrap__select)},o.a.createElement(le,{identificate:"selectDepartmentInUserList",title:"Выберите отдел",defaultValue:s,handleFunction:function(e){f(e)},data:c})))),o.a.createElement("div",null,d.map((function(e,t){return o.a.createElement("div",{key:e.id,className:Z()(me.a["one-row"])},o.a.createElement("div",{className:Z()(me.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(me.a["one-row__name"],me.a["one-row__elem"],me.a["one-row__name_position"])},"".concat(e.name," ").concat(e.surname)),o.a.createElement("div",{className:Z()(me.a["one-row__buttons"],me.a["one-row__elem"],me.a["one-row__buttons_position"])},o.a.createElement(b.b,{to:"/user/".concat(e.id),className:Z()(me.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return function(e){console.log("delete",e);var t=n.filter((function(t){return t.id!==e}));a(t),_().set(t)}(e.id)},className:Z()(me.a["one-row__delete"])},"Удалить")))}))))},ve=n(60),ye=n.n(ve);function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var he=function(e){var t=_e(Object(r.useState)([]),2),n=(t[0],t[1]),a=_e(Object(r.useState)([]),2),l=a[0],c=a[1],i=_e(Object(r.useState)([]),2),u=(i[0],i[1]),s=Object(r.useContext)(p),f=s.getUsersRef,m=s.getDepartmentsRef,d=s.getVacationsRef;Object(r.useEffect)((function(){f().once("value").then((function(e){return e.val()})).then((function(e){return n(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){m().once("value").then((function(e){return e.val()})).then((function(e){return c(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){d().once("value").then((function(e){return e.val()})).then((function(e){return u(e)})).catch((function(e){return console.log(e)}))}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(ye.a["page-title"])},"Список отделов компании"),o.a.createElement("div",{className:Z()(ye.a.wrap)},o.a.createElement(b.b,{to:"department/new-department",className:Z()(ye.a["button-new-object"],ye.a[".button-new-object__text"])},"Добавить отдел")),o.a.createElement("div",null,l.map((function(e,t){return o.a.createElement("div",{key:e.id,className:Z()(ye.a["one-row"])},o.a.createElement("div",{className:Z()(ye.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(ye.a["one-row__name"],ye.a["one-row__elem"],ye.a["one-row__name_position"])},e.name),o.a.createElement("div",{className:Z()(ye.a["one-row__buttons"],ye.a["one-row__elem"],ye.a["one-row__buttons_position"])},o.a.createElement(b.b,{to:"department/".concat(e.id),className:Z()(ye.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return t=e.id,n=l.filter((function(e){return e.id!==t})),c(n),void m().set(n);var t,n},className:Z()(ye.a["one-row__delete"])},"Удалить")))}))))},we=n(89),Ee=n.n(we);function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Se=function(e){var t=e.history,n=Oe(Object(r.useState)(e.match.params.id),2),a=n[0],l=(n[1],Oe(Object(r.useState)([]),2)),c=l[0],i=l[1],u=Oe(Object(r.useState)(""),2),s=u[0],f=u[1],m=Oe(Object(r.useState)(0),2),d=m[0],b=m[1],v=Object(r.useContext)(p).getDepartmentsRef;Object(r.useEffect)((function(){v().once("value").then((function(e){return e.val()})).then((function(e){return i(e),e})).then((function(e){if(console.log(a),"new-department"!==a&&0!==a){console.log(e);var t=e.filter((function(e){return e.id===+a}));console.log(t),f(t[0].name),b(t[0].id),console.log(t[0].name)}else f(""),b((new Date).getTime())})).catch((function(e){return console.log(e)}))}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Ee.a["page-title"])},"new-department"===a?"Новый отдел":"Редактировать отдел"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log(a,d);var n=c.findIndex((function(e){return+e.id==+d}));console.log(c,n),-1!==n?(c[+n].name=s,v().set(c).then((function(){return t.push("/departments")})).catch((function(e){return console.log(e)}))):(c.push({name:s,id:(new Date).getTime()}),console.log(c),v().set(c).then((function(){return t.push("/departments")})).catch((function(e){return console.log(e)})))},className:Z()(Ee.a.form)},o.a.createElement("div",{className:Z()(Ee.a["form-field"],Ee.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"name",className:Z()(Ee.a["select-label"])},"Название отдела:"),o.a.createElement("input",{type:"text",id:"name",name:"name","data-index":d,defaultValue:s,placeholder:s,onChange:function(e){f(e.target.value),b(e.target.dataset.index)},className:Z()(Ee.a["input-elem"])})),o.a.createElement("div",{className:Z()(Ee.a["form-field"])},o.a.createElement("button",{className:Z()(Ee.a["submit-button"])},"Отправить")))))},De=n(46),Ne=n.n(De);function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xe=function(e){var t=Object(r.useContext)(g),n=(t.login,t.userData),a=(t.allUsersData,Ae(Object(r.useState)((new Date).getFullYear()),2)),l=a[0],c=a[1],u=Ae(Object(r.useState)([]),2),s=u[0],f=u[1],m=Ae(Object(r.useState)(0),2),d=m[0],v=m[1],y=Ae(Object(r.useState)([]),2),_=y[0],h=y[1],E=Ae(Object(r.useState)([]),2),j=E[0],S=E[1],D=Object(r.useContext)(p),N=(D.getUsersRef,D.getDepartmentsRef,D.getVacationsRef,D.getYearsRef,Object(i.b)()),A=Object(i.c)((function(e){return e.allUsers})),I=Object(i.c)((function(e){return e.allYears})),x=Object(i.c)((function(e){return e.allDepartments})),F=Object(i.c)((function(e){return e.allVacations}));Object(r.useEffect)((function(){if(+n.role_id===O){var e=x.filter((function(e){return+e.id==+n.department_id}));f(e),v(+e[0].id)}else f(x),v(+x[0].id)}),[x,n]),Object(r.useEffect)((function(){if(+n.role_id===O){var e=F.filter((function(e){return+e.user_id==+n.id}));h(e)}else h(F)}),[F,n]),Object(r.useEffect)((function(){var e=A.filter((function(e){return+e.department_id==+d})).map((function(e){return+e.id})),t=d===w?_.filter((function(e){return new Date(+e.vacation_start).getFullYear()===+l&&new Date(+e.vacation_end).getFullYear()===+l})):_.filter((function(t){return-1!==e.indexOf(+t.user_id)&&new Date(+t.vacation_start).getFullYear()===+l&&new Date(+t.vacation_end).getFullYear()===+l}));S(t)}),[A,_,l,d]),Object(r.useEffect)((function(){console.log(_,F)}));return 0==_.length?o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Нет отпусков")):o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Ne.a["page-title"])},"Список отпусков"),o.a.createElement("div",{className:Z()(Ne.a.wrap)},o.a.createElement("div",{className:Z()(Ne.a["wrap__add-vacation"])},o.a.createElement(b.b,{to:"vacation/new-vacation",className:Z()(Ne.a["button-new-object"],Ne.a[".button-new-object__text"])},"Добавить отпуск")),o.a.createElement("div",{className:Z()(Ne.a.wrap__manage)},o.a.createElement("div",{className:Z()(Ne.a.wrap__year)},o.a.createElement(le,{identificate:"selectYear",title:"Выберите год",defaultValue:(new Date).getFullYear(),handleFunction:function(e){c(+e)},data:I})),o.a.createElement("div",{className:Z()(Ne.a.wrap__select)},o.a.createElement(le,{identificate:"selectDepartmentInVacationList",title:"Выберите отдел",defaultValue:s[0].id,handleFunction:function(e){v(e)},data:s})))),o.a.createElement("div",null,0===j.length?o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Нет отпусков")):j.map((function(e,t){var n=A.length>0?A.find((function(t){return+e.user_id==+t.id})):{name:"Получение имени ...",surname:"Получение фамилии ..."},a="".concat(n.name," ").concat(n.surname);return o.a.createElement("div",{key:e.id,className:Z()(Ne.a["one-row"])},o.a.createElement("div",{className:Z()(Ne.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(Ne.a["one-row__name"],Ne.a["one-row__elem"])},o.a.createElement("span",null,a)),o.a.createElement("div",{className:Z()(Ne.a["one-row__dates"],Ne.a["one-row__elem"])},o.a.createElement("span",null,"".concat(new Date(e.vacation_start).getFullYear(),"-").concat(new Date(e.vacation_start).getMonth()+1,"-").concat(new Date(e.vacation_start).getDate(),"  :  ").concat(new Date(e.vacation_end).getFullYear(),"-").concat(new Date(e.vacation_end).getMonth()+1,"-").concat(new Date(e.vacation_end).getDate()))),o.a.createElement("div",{className:Z()(Ne.a["one-row__buttons"],Ne.a["one-row__elem"])},o.a.createElement(b.b,{to:"vacation/".concat(e.id),className:Z()(Ne.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return t=e.id,void N({type:"DELETE_THIS_VACATION",payload:+t});var t},className:Z()(Ne.a["one-row__delete"])},"Удалить")))}))))},Fe=n(51),Ce=n.n(Fe);function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Re=function(e){var t=e.history,n=Object(r.useContext)(p),a=n.getVacationsRef,l=(n.getUsersRef,ke(Object(r.useState)(e.match.params.id),2)),c=l[0],i=(l[1],ke(Object(r.useState)([]),2)),u=i[0],s=i[1],f=ke(Object(r.useState)([]),2),m=f[0],d=f[1],b=ke(Object(r.useState)(0),2),v=b[0],y=b[1],_=ke(Object(r.useState)(""),2),h=(_[0],_[1]),w=ke(Object(r.useState)(0),2),j=w[0],S=w[1],D=ke(Object(r.useState)(0),2),N=D[0],A=D[1],I=ke(Object(r.useState)(0),2),x=I[0],F=I[1],C=ke(Object(r.useState)(0),2),k=C[0],T=C[1],R=ke(Object(r.useState)(0),2),Y=R[0],P=R[1],M=Object(r.useContext)(g),U=(M.login,M.userData),V=(M.allDepartmentsData,M.allUsersData),L=M.allVacationsData;Object(r.useEffect)((function(){if(+U.role_id===E||+U.role_id===O){var e=V.filter((function(e){return+e.id===U.id}));console.log(e),d(e)}else d(V)}),[V,U]),Object(r.useEffect)((function(){if(s(L),void 0!==c&&"new-vacation"!==c&&0!==c&&L.length>0&&m.length>0){console.log(L,m,c);var e=L.filter((function(e){return e.id===+c})),t=m.find((function(t){return+t.id==+e[0].user_id}));h("".concat(t.name," ").concat(t.surname));var n=e[0].vacation_start;T(n),A("".concat(new Date(n).getFullYear(),"-").concat(new Date(n).getMonth()+1>9?new Date(n).getMonth()+1:"0".concat(new Date(n).getMonth()+1),"-").concat(new Date(n).getDate()>9?new Date(n).getDate():"0".concat(new Date(n).getDate())));var a=e[0].vacation_end;P(a),F("".concat(new Date(a).getFullYear(),"-").concat(new Date(a).getMonth()+1>9?new Date(a).getMonth()+1:"0".concat(new Date(a).getMonth()+1),"-").concat(new Date(a).getDate()>9?new Date(a).getDate():"0".concat(new Date(a).getDate()))),S(e[0].id),y(+t.id)}else h("Имя нового отпускника"),S((new Date).getTime()),m[0]?y(m[0].id):y(0)}),[m,L]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Ce.a["page-title"])},"new-vacation"===c?"Новый отпуск":"Отпуск для пользователя"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=u.findIndex((function(e){return+e.id==+j}));-1!==n?(u[+n].user_id=v,u[+n].vacation_end=Y,u[+n].vacation_start=k,0!==v&&0!==Y&&0!==k?a().set(u).then((function(){return t.push("/vacations")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных")):(u.push({user_id:v,vacation_end:Y,vacation_start:k,id:(new Date).getTime()}),0!==v&&0!==Y&&0!==k?a().set(u).then((function(){return t.push("/vacations")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных"))},className:Z()(Ce.a.form)},o.a.createElement("div",{className:Z()(Ce.a["form-field"],Ce.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"user",className:Z()(Ce.a["select-label"])},"Пользователь:"),o.a.createElement("select",{id:"user",name:"user",value:+v,onChange:function(e){y(e.target.value)},className:Z()(Ce.a["select-element"])},m.map((function(e){var t="".concat(e.name," ").concat(e.surname);return o.a.createElement("option",{key:e.id,value:+e.id},t)})))),o.a.createElement("div",{className:Z()(Ce.a["form-field"],Ce.a["form-field__input-date-wrap"])},o.a.createElement("label",{htmlFor:"vacation_start",className:Z()(Ce.a["select-label"])},"Начало отпускного периода:"),o.a.createElement("input",{type:"date",id:"vacation_start",name:"vacation_start",value:N,onChange:function(e){A(e.target.value),T(e.target.valueAsNumber)},className:Z()(Ce.a["date-input"])})),o.a.createElement("div",{className:Z()(Ce.a["form-field"],Ce.a["form-field__input-date-wrap"])},o.a.createElement("label",{htmlFor:"vacation_end",className:Z()(Ce.a["select-label"])},"Конец отпускного периода:"),o.a.createElement("input",{type:"date",id:"vacation_end",name:"vacation_end",value:x,onChange:function(e){F(e.target.value),P(e.target.valueAsNumber)},className:Z()(Ce.a["date-input"])})),o.a.createElement("div",{className:Z()(Ce.a["form-field"])},o.a.createElement("button",{className:Z()(Ce.a["submit-button"])},"Отправить")))))},Ye=n(34),Pe=n.n(Ye);function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ve=function(e){var t=e.history,n=Object(r.useContext)(p),a=n.getRolesRef,l=n.getUsersRef,c=(n.getDepartmentsRef,Me(Object(r.useState)(e.match.params.id),2)),i=c[0],u=(c[1],Me(Object(r.useState)([]),2)),s=u[0],f=u[1],m=Me(Object(r.useState)(0),2),d=(m[0],m[1],Me(Object(r.useState)(""),2)),b=d[0],v=d[1],y=Me(Object(r.useState)(""),2),_=y[0],h=y[1],w=Me(Object(r.useState)(""),2),O=w[0],j=w[1],S=Me(Object(r.useState)([]),2),D=S[0],N=S[1],A=Me(Object(r.useState)(0),2),I=A[0],x=A[1],F=Me(Object(r.useState)([]),2),C=F[0],k=F[1],T=Me(Object(r.useState)(0),2),R=T[0],Y=T[1],P=Object(r.useContext)(g),M=(P.userData,P.allDepartmentsData),U=P.allUsersData;P.allVacationsData;Object(r.useEffect)((function(){a().once("value").then((function(e){return e.val()})).then((function(e){return N(e)})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за юзерами")}))}),[]),Object(r.useEffect)((function(){if(i&&s.length>0&&D.length>0)if("new-user"===i){var e=D.find((function(e){return+e.id===E}));x(+e.id)}else{var t=s.find((function(e){return+e.id==+i}));if(void 0!==t.role_id)x(+t.role_id);else{var n=D.find((function(e){return+e.id===E}));x(+n.id)}}}),[s,D]),Object(r.useEffect)((function(){f(U)}),[U]),Object(r.useEffect)((function(){var e=M.filter((function(e){return 99999!=+e.id&&"Все"!==e.name}));k(e)}),[M]),Object(r.useEffect)((function(){if(console.log(s,C,i),"new-user"!==i&&s.length>0&&void 0!==i){var e=s.find((function(e){return+e.id==+i}));v(e.name),h(e.surname),j(e.login),Y(+e.department_id)}"new-user"===i&&C.length>0&&Y(+C[0].id)}),[C,s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Pe.a["page-title"])},"new-user"===i?"Новый пользователь":"Редактировать пользователя"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=s.findIndex((function(e){return+e.id==+i}));-1!==n?(s[+n].name=b,s[+n].surname=_,s[+n].login=O,s[+n].department_id=R,s[+n].role_id=I,""!==b&&""!==_&&""!==O&&""!==R?l().set(s).then((function(){return t.push("/users")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных")):(s.push({name:b,surname:_,login:O,id:(new Date).getTime(),department_id:R,role_id:I}),""!==b&&""!==_&&""!==O&&""!==R?l().set(s).then((function(){return t.push("/users")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных"))},className:Z()(Pe.a.form)},o.a.createElement("div",{className:Z()(Pe.a["form-field"],Pe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"name",className:Z()(Pe.a["select-label"])},"Имя:"),o.a.createElement("input",{type:"text",id:"name",name:"name",defaultValue:b,onChange:function(e){v(e.target.value)},className:Z()(Pe.a["input-elem"])})),o.a.createElement("div",{className:Z()(Pe.a["form-field"],Pe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"surname",className:Z()(Pe.a["select-label"])},"Фамилия:"),o.a.createElement("input",{type:"text",id:"surname",name:"surname",defaultValue:_,onChange:function(e){h(e.target.value)},className:Z()(Pe.a["input-elem"])})),o.a.createElement("div",{className:Z()(Pe.a["form-field"],Pe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"login",className:Z()(Pe.a["select-label"])},"Логин:"),o.a.createElement("input",{type:"text",id:"login",name:"login",defaultValue:O,onChange:function(e){j(e.target.value)},className:Z()(Pe.a["input-elem"])})),o.a.createElement("div",{className:Z()(Pe.a["form-field"],Pe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"departament",className:Z()(Pe.a["select-label"])},"Отдел:"),o.a.createElement("select",{id:"departament",name:"departament",value:+R,onChange:function(e){Y(e.target.value)},className:Z()(Pe.a["select-element"])},C.map((function(e){return o.a.createElement("option",{key:+e.id,value:+e.id},e.name)})))),o.a.createElement("div",{className:Z()(Pe.a["form-field"],Pe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"roles",className:Z()(Pe.a["select-label"])},"Набор прав:"),o.a.createElement(le,{identificate:"roles",title:"Выберите набор прав",defaultValue:+I,handleFunction:function(e){x(+e)},data:D,className:Z()(Pe.a["select-component"])})),o.a.createElement("div",{className:Z()(Pe.a["form-field"])},o.a.createElement("button",{className:Z()(Pe.a["submit-button"])},"Отправить")))))};function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Je=function(e){e.login;var t=e.userData,n=Le(Object(r.useState)(+E),2),a=n[0],l=n[1];return Object(r.useEffect)((function(){t&&l(+t.role_id)}),[t]),o.a.createElement(u.d,null,o.a.createElement(u.b,{path:"/auth",render:function(e){return o.a.createElement(G,e)}}),a!==E?a!==O?o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{path:_.users.url,component:be}),o.a.createElement(z,{path:_.user.url,component:Ve}),o.a.createElement(z,{path:_["new-user"].url,component:Ve}),o.a.createElement(z,{path:_.departments.url,component:he}),o.a.createElement(z,{path:_.department.url,component:Se}),o.a.createElement(z,{path:_["new-department"].url,component:Se}),o.a.createElement(z,{path:_.vacations.url,component:xe}),o.a.createElement(z,{path:_.vacation.url,component:Re}),o.a.createElement(z,{path:_["new-vacation"].url,component:Re}),o.a.createElement(z,{path:_.home.url,exact:!0,component:se})):o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{path:_.vacations.url,component:xe}),o.a.createElement(z,{path:_.vacation.url,component:Re}),o.a.createElement(z,{path:_["new-vacation"].url,component:Re}),o.a.createElement(z,{path:_.home.url,exact:!0,component:se})):o.a.createElement(z,{path:_.home.url,exact:!0,component:se}),o.a.createElement(u.a,{to:"/"}))};function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ze(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Be=function(){var e=Object(r.useContext)(p),t=e.auth,n=e.getUsersRef,a=e.getDepartmentsRef,l=e.getVacationsRef,c=e.getYearsRef,u=qe(Object(r.useState)(!0),2),s=u[0],f=u[1],m=qe(Object(r.useState)(!1),2),d=(m[0],m[1]),v=qe(Object(r.useState)(""),2),y=v[0],_=v[1],h=qe(Object(r.useState)(null),2),w=h[0],E=h[1],O=Object(i.c)((function(e){return e.allDepartments})),j=Object(i.c)((function(e){return e.allVacations})),S=Object(i.c)((function(e){return e.allUsers})),D=Object(i.c)((function(e){return e.allYears})),N=Object(i.b)();Object(r.useEffect)((function(){a().on("value",(function(e){N({type:"ADD_ALL_DEPARTMENTS",payload:e.val()})}))}),[]),Object(r.useEffect)((function(){try{l().on("value",(function(e){N({type:"ADD_ALL_VACATIONS",payload:e.val()})}))}catch(e){console.log(e)}}),[]),Object(r.useEffect)((function(){localStorage.getItem("userId")?(console.log("we know who are you!"),t.onAuthStateChanged((function(e){f(!1),e?(d(e.uid),localStorage.setItem("userId",JSON.stringify(e.uid)),_(e.email),n().on("value",(function(t){var n=t.val();N({type:"ADD_ALL_USERS",payload:n});var a=n.find((function(t){return t.login===e.email}));E(a)}))):(d(!1),localStorage.removeItem("userId"))}))):(console.log("we don`t know who are you!"),d(!1),f(!1))}),[]),Object(r.useEffect)((function(){c().once("value").then((function(e){return e.val()})).then((function(e){return N({type:"ADD_ALL_YEARS",payload:e})})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за годами")}))}),[]);var A=Je({login:y,userData:w});return s?o.a.createElement(Y,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,null,o.a.createElement(g.Provider,{value:{login:y,userData:w,allDepartmentsData:O,allUsersData:S,allVacationsData:j,allYearsData:D}},A)))},Ze=(n(622),n(171));n(623),n(625);function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var He={apiKey:"AIzaSyCcY9SjOgc7yL6UihqaIq0wwlULYGIBnmM",authDomain:"vacations-app-9686b.firebaseapp.com",databaseURL:"https://vacations-app-9686b.firebaseio.com",projectId:"vacations-app-9686b",storageBucket:"vacations-app-9686b.appspot.com",messagingSenderId:"533684716413",appId:"1:533684716413:web:b66c494c733440e3b5c214"},Qe=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),We(this,"signWithEmail",(function(e,n){return t.auth.signInWithEmailAndPassword(e,n)})),We(this,"getRolesRef",(function(){return t.database.ref("/roles/")})),We(this,"getYearsRef",(function(){return t.database.ref("/years/")})),We(this,"getDepartmentsRef",(function(){return t.database.ref("/departments/")})),We(this,"getUsersRef",(function(){return t.database.ref("/users/")})),We(this,"getVacationsRef",(function(){return t.database.ref("/vacations/")})),We(this,"requestRef",(function(e){return t.database.ref(e)})),Ze.a.initializeApp(He),this.auth=Ze.a.auth(),this.database=Ze.a.database(),this.userUid=null},Ke=n(160);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){et(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tt={allDepartments:[],allUsers:[],allVacations:[],allYears:[]};var nt=Object(Ke.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0,n=(Qe.auth,Qe.getUsersRef,Qe.getDepartmentsRef,Qe.getVacationsRef);switch(Qe.getYearsRef,t.type){case"ADD_ALL_DEPARTMENTS":var a=$e({},e);return a.allDepartments=t.payload,a;case"ADD_ALL_VACATIONS":var r=$e({},e);return r.allVacations=t.payload,r;case"ADD_ALL_USERS":var o=$e({},e);return o.allUsers=t.payload,o;case"DELETE_THIS_VACATION":var l=$e({},e),c=l.allVacations.filter((function(e){return+e.id!=+t.payload}));return l.allVacations=c,n().set(c),l;case"SET_VACATIONS":var i=$e({},e);return i.allVacations=t.payload,n().set(i.allVacations),i;case"ADD_ALL_YEARS":var u=$e({},e);return u.allYears=t.payload,u;default:return e}}));c.a.render(o.a.createElement(p.Provider,{value:Qe},o.a.createElement(i.a,{store:nt},o.a.createElement(Be,null))),document.getElementById("root"))},88:function(e,t,n){e.exports={"content-title-block":"_3FNGMQ-zE50K4_ifpTiNmy","content-title-block__start-elem":"b36pquR0MFSJXNp-Muc9Z","content-title-block__elem":"_2-uWuAN1CGzVB5jO8LSwZm","page-title":"_1_UtturgCpyauKdEYtsVhx",wrap__manage:"_2JWJY8EB5vUDCsoeEmlpcb",wrap__select:"_5Rz1iDmOyhgHtaA6uVAOA",wrap__year:"_150dlS6aiBFL_J0KA0102k"}},89:function(e,t,n){e.exports={"page-title":"_2Lfe4Mtw8jkbQyA3josbay",form:"_3drwl5dPG9MNs31fnmBEvZ","form-field":"CnfZpkfu4LmDsUVWegHi_","form-field__select-wrap":"_3apSygjN4jJ5Sih86n8zTo","input-elem":"_2-OVDSQThvS-tZbjD1a68f","submit-button":"_1AaHCZVC1aEnBUPjaDF0kr"}}});