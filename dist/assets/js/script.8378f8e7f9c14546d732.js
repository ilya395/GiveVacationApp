!function(e){function t(t){for(var a,l,c=t[0],i=t[1],u=t[2],m=0,f=[];m<c.length;m++)l=c[m],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&f.push(r[l][0]),r[l]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(s&&s(t);f.length;)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,c=1;c<n.length;c++){var i=n[c];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},r={0:0},o=[];function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var c=window.webpackJsonp=window.webpackJsonp||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=i;o.push([288,1]),n()}({168:function(e,t,n){e.exports={root:"_3mzvt2dfIcxezlBOA_zAyl","start-col":"_3BOOTK9MCLyWGkRfwokeSU",col:"_3jgevgdoAcNg41bS9Di1ok"}},208:function(e,t,n){e.exports={root:"_1Tsp9tDRxFDaCmH9rOQGnQ","inner-elem":"_2iThc5dqDVtQ9k1akJVwOr",start:"y9nOZJSfJPtqkI3MhfJq9",end:"_3fu-yG2kfRcor4IljHOnon"}},284:function(e,t,n){e.exports={"select-element":"_2ctkSYaW2EH_keCx5s1m3e"}},288:function(e,t,n){n(289),e.exports=n(623)},34:function(e,t,n){e.exports={"page-title":"_3SFFJOXbud1k2janVVLpfG",form:"_2ZCOB-XfI4r1DS0LU92GiB","form-field":"_191R7kZB47ncfKa-dfXSGS","form-field__select-wrap":"WxvaEylXGJJ-6JggBkv4H","select-label":"_3OGZzezyoVTM48ZqOqmGgP","select-element":"_332UtWNFZchEpcLkIhRWa","input-elem":"_5XGyOba1Eb395OX_VziUn","form-field__input-date-wrap":"_1ePDtYdnBVrUNZD6Q-xqSF","date-input":"_2uoUyIeUMAuzuFUys1tuk4","submit-button":"T5FespIgZ97wanDaisqtO","select-component":"_2qPLoP8uAavsn5Y8lqYt7d"}},46:function(e,t,n){e.exports={"page-title":"_2jDy73cdxRg-Iudg1deQfv","button-new-object":"_12QqcsRMtYgWEvHalIsuwr","button-new-object__text":"_2pzb4YgRDF6lSRTdecCDv3",wrap:"_3GIJehpypSDZhx454yqVJ",wrap__manage:"_18galqCmAJrrvT9-GzQd36",wrap__select:"_24ra3z2p7LchnuvKqHw57i",wrap__year:"_38v1ZvAIdWdpPO9A53ZEZA","one-row":"_1dDAuYKonLDsUDVf-kkDIP","one-row__number":"YHGLrO65hMGx5o8VEeM7S","one-row__elem":"_2NTEiRMdBmvKh47gjsJiQH","one-row__buttons":"_1qcwfV9tMQTp6T9XsDUFbh","one-row__redaction":"_3lwIgGf9OtNin9YJAqxfzB","one-row__delete":"_366yikAp2AnNIK4ot0XeXT"}},478:function(e,t,n){},479:function(e,t,n){},49:function(e,t,n){e.exports={"page-title":"_2-k3FYOPrLISgLXBykC8sN","button-new-object":"_3TW37yoBtHB-Bw4HQPwv3y","button-new-object__text":"_2wHhUmTv4QDY3t_MbYtPy8",wrap:"_1DNvf0QXOMJVX3cII7ND-D",wrap__manage:"_3ZPlpjT_ocRb7FIKf3mYYM",wrap__select:"_1U3SCqpegzboLEcTzNNDB2",wrap__year:"_3yu5OCTrHNuG-_vKR50DBI","one-row":"k4II8IW3WBuDV5J0kPFwh","one-row__number":"_2ApsrToSdo1tUgswG4kzsG","one-row__elem":"_7airtp7tUiymkRYapwa_","one-row__name_position":"_10vycUjJQLrs0e5KYUmrlJ","one-row__buttons_position":"_11vjfBbwB8tLp_Op12mHOF","one-row__buttons":"_1aYOD30kO2hPA1WEgE1BYZ","one-row__redaction":"iAPBMqWISb32d0qJo-oil","one-row__delete":"_3VwGWA_PqTZHGpNMonQD_n"}},51:function(e,t,n){e.exports={"page-title":"_2mExhhM5jAILzoiNju52Po",form:"nfFaYQxcDQPh72oufHiNU","form-field":"_1cadmoRwa6Zfg7osvTfz9n","form-field__select-wrap":"TKYqMSoCWoh0RxFGzjl9s","select-label":"_36a6_DyivUl6tB7_PZwGUT","select-element":"_3E7dPJGQTabkCd7x8wTJpK","form-field__input-date-wrap":"_3mkGR6c2mGtdNJ_6ZchWeN","date-input":"KlkYhcEf3Flk91ImRR5__","submit-button":"_1TCWZm2lwuQIWY1NLXdp59"}},537:function(e,t,n){},538:function(e,t,n){},59:function(e,t,n){e.exports={"page-title":"_38q-9poBQkyqGaWcx6-viG","button-new-object":"_2k2lpxZSN5otGYn3HmArxJ","button-new-object__text":"_2d4AEC2ESCS0z9G3UTNyYR",wrap:"_1eheVT3tBtToQ-CGA0WtpJ",wrap__manage:"_3b-ypER_K2igF4JPTktcla",wrap__select:"_2rKq9LNy6IkHI1qITHzsVk",wrap__year:"_3RTqoWOUq5m5pbMStf3oVR","one-row":"_2agi48okGSt1XZjahPPOZJ","one-row__number":"_2RCznjSWuPGOLYcyLY2XTZ","one-row__elem":"Pih9F-rb87ymQ3t-t6nSg","one-row__name_position":"_1ClEEGLlf9dNTMF41Ia456","one-row__buttons_position":"_2dgFWx4QP3w_xZrtC2EL7B","one-row__buttons":"_1EbMRE1YbeYC5Pl1nEOPIp","one-row__redaction":"_3mM2ks5Ols_nVOFWixhH9g","one-row__delete":"_3p6wK-zIbUVCOxg2NJ-ki7"}},617:function(e,t,n){},623:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),l=n(25),c=n.n(l),i=(n(478),n(40)),u=(n(479),n(624)),s=n(627),m=n(285),f=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(m.a,{type:"primary",danger:!0,onClick:e.logoutPlz},"Выйти"))},d=o.a.createContext(null),p=n(45),b=n(628);function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=(v(a={home:{title:"Главная",url:"/"},users:{title:"Пользователи",url:"/users"},user:{title:"Пользователь",url:"/user/:id"}},"new-user",{title:"Пользователи",url:"/user/new-user"}),v(a,"vacations",{title:"Отпуска",url:"/vacations"}),v(a,"vacation",{title:"Отпуск",url:"/vacation/:id"}),v(a,"new-vacation",{title:"Новый отпуск",url:"/vacation/new-vacation"}),v(a,"departments",{title:"Отделы",url:"/departments"}),v(a,"department",{title:"Отдел",url:"/department/:id"}),v(a,"new-department",{title:"Новый отдел",url:"/department/new-department"}),a),y=o.a.createContext(null),_=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],h=99999,w=900,E=901;function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var S=function(){var e=Object(r.useContext)(y),t=(e.login,e.userData);console.log(Object(r.useContext)(y));var n=O(Object(r.useState)(w),2),a=n[0],l=n[1];return Object(r.useEffect)((function(){t&&l(t.role_id)}),[t]),o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,{theme:"dark",mode:"horizontal"},o.a.createElement(b.a.Item,{key:"1"},o.a.createElement(p.c,{to:g.home.url},g.home.title)),a!==w?a!==E?o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a.Item,{key:"2"},o.a.createElement(p.c,{to:g.users.url},g.users.title)),o.a.createElement(b.a.Item,{key:"3"},o.a.createElement(p.c,{to:g.vacations.url},g.vacations.title)),o.a.createElement(b.a.Item,{key:"4"},o.a.createElement(p.c,{to:g.departments.url},g.departments.title))):o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a.Item,{key:"3"},o.a.createElement(p.c,{to:g.vacations.url},g.vacations.title))):o.a.createElement(o.a.Fragment,null)))};function D(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var N=u.a.Header,A=u.a.Content,I=u.a.Footer,x=(s.a.Title,function(e){var t=e.children,n=D(e,["children"]),a=Object(r.useContext)(d).auth,l=n.history;return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{className:"layout"},o.a.createElement(N,null,o.a.createElement("i",{style:{color:"rgba(255, 255, 255, 0.65)"}},"когданибудьздесьбудетлого"),o.a.createElement(S,null),o.a.createElement("div",null,o.a.createElement(f,{logoutPlz:function(){console.log("ок, logout"),a.signOut(),localStorage.removeItem("userId"),l.push("/auth")}}))),o.a.createElement(A,{style:{padding:"0 50px",overflow:"auto"}},o.a.createElement("div",{className:"site-layout-content"},t)),o.a.createElement(I,{style:{textAlign:"center"}},"Created by DVM-Group")))}),F=(n(537),n(626)),C=n(629),k=n(630),M=n(625),Y=(n(538),function(){return o.a.createElement("div",{className:"work-area preloader"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"preloader-wrapper big active"},o.a.createElement(k.b,{size:"middle"},o.a.createElement(M.a,{size:"large"})))))});function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var P={labelCol:{span:8},wrapperCol:{span:16}},V={wrapperCol:{offset:8,span:16}},G=function(e){var t=T(Object(r.useState)(!0),2),n=t[0],a=t[1];Object(r.useEffect)((function(){return a(!1)}),[]);var l=T(Object(r.useState)(null),2),c=l[0],i=l[1];Object(r.useEffect)((function(){var t=e.history;i(t)}),[e]);var u=T(Object(r.useState)(!1),2),s=u[0],f=u[1],p=Object(r.useContext)(d).signWithEmail;Object(r.useEffect)((function(){!0===s&&c.push("/")}),[s,c]);return n?o.a.createElement(Y,null):o.a.createElement("div",{className:"form-wrap"},o.a.createElement(F.a,R({},P,{name:"basic",initialValues:{remember:!0},onFinish:function(e){var t=e.email,n=e.password;p(t,n).then((function(e){console.log("Success!"),f(!0),localStorage.setItem("userId",e.user.uid),c.push("/")})).catch((function(){console.log("кто ты тварь?"),f(!1)}))},onFinishFailed:function(e){console.log("Failed:",e)},className:"form"}),o.a.createElement(F.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}]},o.a.createElement(C.a,null)),o.a.createElement(F.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},o.a.createElement(C.a.Password,null)),o.a.createElement(F.a.Item,V,o.a.createElement(m.a,{type:"primary",htmlType:"submit"},"Войти"))))};function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var z=function(e){var t=e.component,n=q(e,["component"]);return o.a.createElement(i.b,J({},n,{render:function(e){return localStorage.getItem("userId")?o.a.createElement(x,null,o.a.createElement(t,e)):o.a.createElement(i.a,{to:"/auth"})}}))},B=n(2),Z=n.n(B),L=n(87),W=n.n(L),Q=n(168),H=n.n(Q),K=n(208),X=n.n(K),$=function(e){var t=e.data,n=(e.name,e.index,31);return t&&(n=new Date(t[0].year,t[0].monthNumber,0).getDate()),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Z()(X.a.root)},null!=t?o.a.createElement("div",{className:Z()(X.a["inner-elem"]),style:{left:"".concat((t[0].day-1)/(n-1)*100,"%"),right:"".concat(n===+t[1].day?0:(n-1-(+t[1].day-1))/(n-1)*100,"%")}}):o.a.createElement(o.a.Fragment,null)))},ee=function(e){var t=e.name,n=(e.id,e.vacations);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:Z()(H.a.root)},o.a.createElement("div",{className:Z()(H.a["start-col"])},t),_.map((function(e,a){var r=n.find((function(e){return+e[0].monthNumber==+a}));return o.a.createElement("div",{key:a,className:Z()(H.a.col)},o.a.createElement($,{data:r||null,name:t,index:+a}))}))))},te=n(284),ne=n.n(te);function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var oe=function(e){var t=e.identificate,n=(e.title,e.defaultValue),a=e.handleFunction,l=e.data,c=ae(Object(r.useState)(n),2),i=c[0],u=c[1];Object(r.useEffect)((function(){u(n)}),[n]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("select",{id:t,name:t,value:+i,onChange:function(e){a(+e.target.value),u(+e.target.value)},className:Z()(ne.a["select-element"])},l.map((function(e){return o.a.createElement("option",{key:e.id,value:+e.id},e.name)}))))};function le(){return(le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ue=function(e){var t=ce(Object(r.useState)([]),2),n=t[0],a=t[1],l=ce(Object(r.useState)([]),2),c=l[0],i=l[1],u=ce(Object(r.useState)([]),2),s=u[0],m=u[1],f=ce(Object(r.useState)([]),2),p=f[0],b=f[1],v=ce(Object(r.useState)(2021),2),g=(v[0],v[1],ce(Object(r.useState)(0),2)),O=g[0],j=g[1],S=ce(Object(r.useState)([]),2),D=S[0],N=S[1],A=ce(Object(r.useState)((new Date).getFullYear()),2),I=A[0],x=A[1],F=Object(r.useContext)(d),C=(F.getUsersRef,F.getDepartmentsRef,F.getVacationsRef,F.getYearsRef),k=Object(r.useContext)(y),M=k.userData,Y=k.allUsersData,R=k.allVacationsData,T=k.allDepartmentsData,U=ce(Object(r.useState)(w),2),P=U[0],V=U[1],G=ce(Object(r.useState)(0),2),J=G[0],q=G[1];Object(r.useEffect)((function(){C().once("value").then((function(e){return e.val()})).then((function(e){return N(e)})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за годами")}))}),[]),Object(r.useEffect)((function(){a(Y)}),[Y]),Object(r.useEffect)((function(){if(+P===w||+P===E&&T.length>0){var e=T.filter((function(e){return+e.id==+J}));e.length>0&&(i(e),j(e[0].id))}else{T.find((function(e){return e.id===h}))?(i(T),j(T[0].id)):(T.unshift({id:h,name:"Все"}),i(T),j(T[0].id))}}),[T,P,J]),Object(r.useEffect)((function(){m(R)}),[R]),Object(r.useEffect)((function(){var e=(O===h?n:n.filter((function(e){return+e.department_id==+O}))).map((function(e){var t=s.filter((function(t){return+t.user_id==+e.id&&new Date(+t.vacation_start).getFullYear()===I})),n=[];return t.forEach((function(e){var t=e.vacation_start,a=e.vacation_end;new Date(t).getMonth()===new Date(a).getMonth()?n.push([{type:"start",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(+e.vacation_start).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_start},{type:"end",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(+e.vacation_end).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end}]):(n.push([{type:"start",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(+e.vacation_start).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_start},{type:"end",monthNumber:new Date(+e.vacation_start).getMonth(),day:new Date(new Date(+e.vacation_start).getFullYear(),new Date(+e.vacation_start).getMonth()+1,0).getDate(),year:new Date(+e.vacation_start).getFullYear(),date:e.vacation_end}]),n.push([{type:"start",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(new Date(+e.vacation_end).getFullYear(),new Date(+e.vacation_end).getMonth(),1).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end},{type:"end",monthNumber:new Date(+e.vacation_end).getMonth(),day:new Date(+e.vacation_end).getDate(),year:new Date(+e.vacation_end).getFullYear(),date:e.vacation_end}]))})),{name:"".concat(e.name," ").concat(e.surname),id:e.id,vacations:n}}));b(e)}),[n,s,c,I,O]),Object(r.useEffect)((function(){M&&(V(M.role_id),q(M.department_id))}),[M]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(W.a["page-title"])},"Расписание, дорогой(-ая)!"),o.a.createElement("div",{className:Z()(W.a.wrap__manage)},o.a.createElement("div",{className:Z()(W.a.wrap__year)},o.a.createElement(oe,{identificate:"selectYear",title:"Выберите год",defaultValue:(new Date).getFullYear(),handleFunction:function(e){x(+e)},data:D})),o.a.createElement("div",{className:Z()(W.a.wrap__select)},o.a.createElement(oe,{identificate:"selectDepartmentOnMainPage",title:"Выберите отдел",defaultValue:O,handleFunction:function(e){j(+e)},data:c}))),o.a.createElement("div",null,o.a.createElement("div",{className:Z()(W.a["content-title-block"])},o.a.createElement("div",{className:Z()(W.a["content-title-block__start-elem"])},"Пользователи"),_.map((function(e){return o.a.createElement("div",{key:e,className:Z()(W.a["content-title-block__elem"])},e)}))),o.a.createElement("div",{className:Z()(W.a["content-body-block"])},p.map((function(e){return o.a.createElement(ee,le({key:e.id},e))})))))},se=n(49),me=n.n(se);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var pe=function(e){var t=fe(Object(r.useState)([]),2),n=t[0],a=t[1],l=fe(Object(r.useState)([]),2),c=l[0],i=l[1],u=fe(Object(r.useState)(0),2),s=u[0],m=u[1],f=fe(Object(r.useState)([]),2),b=f[0],v=f[1],g=Object(r.useContext)(d),y=g.getUsersRef,_=g.getDepartmentsRef;Object(r.useEffect)((function(){y().once("value").then((function(e){return e.val()})).then((function(e){return a(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){_().once("value").then((function(e){return e.val()})).then((function(e){e.unshift({id:h,name:"Все"}),i(e),m(e[0].id)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){var e=s===h?n:n.filter((function(e){return+e.department_id==+s}));v(e)}),[s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(me.a["page-title"])},"Список пользователей"),o.a.createElement("div",{className:Z()(me.a.wrap)},o.a.createElement("div",{className:Z()(me.a["wrap__add-vacation"])},o.a.createElement(p.b,{to:"user/new-user",className:Z()(me.a["button-new-object"],me.a[".button-new-object__text"])},"Новый пользователь")),o.a.createElement("div",{className:Z()(me.a.wrap__manage)},o.a.createElement("div",{className:Z()(me.a.wrap__select)},o.a.createElement(oe,{identificate:"selectDepartmentInUserList",title:"Выберите отдел",defaultValue:s,handleFunction:function(e){m(e)},data:c})))),o.a.createElement("div",null,b.map((function(e,t){return o.a.createElement("div",{key:e.id,className:Z()(me.a["one-row"])},o.a.createElement("div",{className:Z()(me.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(me.a["one-row__name"],me.a["one-row__elem"],me.a["one-row__name_position"])},"".concat(e.name," ").concat(e.surname)),o.a.createElement("div",{className:Z()(me.a["one-row__buttons"],me.a["one-row__elem"],me.a["one-row__buttons_position"])},o.a.createElement(p.b,{to:"/user/".concat(e.id),className:Z()(me.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return function(e){console.log("delete",e);var t=n.filter((function(t){return t.id!==e}));a(t),y().set(t)}(e.id)},className:Z()(me.a["one-row__delete"])},"Удалить")))}))))},be=n(59),ve=n.n(be);function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var _e=function(e){var t=ge(Object(r.useState)([]),2),n=(t[0],t[1]),a=ge(Object(r.useState)([]),2),l=a[0],c=a[1],i=ge(Object(r.useState)([]),2),u=(i[0],i[1]),s=Object(r.useContext)(d),m=s.getUsersRef,f=s.getDepartmentsRef,b=s.getVacationsRef;Object(r.useEffect)((function(){m().once("value").then((function(e){return e.val()})).then((function(e){return n(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){f().once("value").then((function(e){return e.val()})).then((function(e){return c(e)})).catch((function(e){return console.log(e)}))}),[]),Object(r.useEffect)((function(){b().once("value").then((function(e){return e.val()})).then((function(e){return u(e)})).catch((function(e){return console.log(e)}))}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(ve.a["page-title"])},"Список отделов компании"),o.a.createElement("div",{className:Z()(ve.a.wrap)},o.a.createElement(p.b,{to:"department/new-department",className:Z()(ve.a["button-new-object"],ve.a[".button-new-object__text"])},"Добавить отдел")),o.a.createElement("div",null,l.map((function(e,t){return o.a.createElement("div",{key:e.id,className:Z()(ve.a["one-row"])},o.a.createElement("div",{className:Z()(ve.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(ve.a["one-row__name"],ve.a["one-row__elem"],ve.a["one-row__name_position"])},e.name),o.a.createElement("div",{className:Z()(ve.a["one-row__buttons"],ve.a["one-row__elem"],ve.a["one-row__buttons_position"])},o.a.createElement(p.b,{to:"department/".concat(e.id),className:Z()(ve.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return t=e.id,n=l.filter((function(e){return e.id!==t})),c(n),void f().set(n);var t,n},className:Z()(ve.a["one-row__delete"])},"Удалить")))}))))},he=n(88),we=n.n(he);function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var je=function(e){var t=e.history,n=Ee(Object(r.useState)(e.match.params.id),2),a=n[0],l=(n[1],Ee(Object(r.useState)([]),2)),c=l[0],i=l[1],u=Ee(Object(r.useState)(""),2),s=u[0],m=u[1],f=Ee(Object(r.useState)(0),2),p=f[0],b=f[1],v=Object(r.useContext)(d).getDepartmentsRef;Object(r.useEffect)((function(){v().once("value").then((function(e){return e.val()})).then((function(e){return i(e),e})).then((function(e){if(console.log(a),"new-department"!==a&&0!==a){console.log(e);var t=e.filter((function(e){return e.id===+a}));console.log(t),m(t[0].name),b(t[0].id),console.log(t[0].name)}else m(""),b((new Date).getTime())})).catch((function(e){return console.log(e)}))}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(we.a["page-title"])},"new-department"===a?"Новый отдел":"Редактировать отдел"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log(a,p);var n=c.findIndex((function(e){return+e.id==+p}));console.log(c,n),-1!==n?(c[+n].name=s,v().set(c).then((function(){return t.push("/departments")})).catch((function(e){return console.log(e)}))):(c.push({name:s,id:(new Date).getTime()}),console.log(c),v().set(c).then((function(){return t.push("/departments")})).catch((function(e){return console.log(e)})))},className:Z()(we.a.form)},o.a.createElement("div",{className:Z()(we.a["form-field"],we.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"name",className:Z()(we.a["select-label"])},"Название отдела:"),o.a.createElement("input",{type:"text",id:"name",name:"name","data-index":p,defaultValue:s,placeholder:s,onChange:function(e){m(e.target.value),b(e.target.dataset.index)},className:Z()(we.a["input-elem"])})),o.a.createElement("div",{className:Z()(we.a["form-field"])},o.a.createElement("button",{className:Z()(we.a["submit-button"])},"Отправить")))))},Se=n(46),De=n.n(Se);function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ie=function(e){var t=Object(r.useContext)(y),n=t.login,a=t.userData,l=t.allDepartmentsData,c=t.allUsersData,i=t.allVacationsData;console.log(n);var u=Ne(Object(r.useState)([]),2),s=u[0],m=u[1],f=Ne(Object(r.useState)((new Date).getFullYear()),2),b=f[0],v=f[1],g=Ne(Object(r.useState)([]),2),_=g[0],w=g[1],O=Ne(Object(r.useState)([]),2),j=O[0],S=O[1],D=Ne(Object(r.useState)(0),2),N=D[0],A=D[1],I=Ne(Object(r.useState)([]),2),x=I[0],F=I[1],C=Ne(Object(r.useState)([]),2),k=C[0],M=C[1],Y=Object(r.useContext)(d),R=(Y.getUsersRef,Y.getDepartmentsRef,Y.getVacationsRef),T=Y.getYearsRef;Object(r.useEffect)((function(){T().once("value").then((function(e){return e.val()})).then((function(e){return m(e)})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за годами")}))}),[]),Object(r.useEffect)((function(){w(c)}),[c]),Object(r.useEffect)((function(){if(+a.role_id===E){var e=l.filter((function(e){return+e.id==+a.department_id}));S(e),A(+e[0].id)}else S(l),A(+l[0].id)}),[l,a]),Object(r.useEffect)((function(){if(+a.role_id===E){var e=i.filter((function(e){return+e.user_id==+a.id}));F(e)}else F(i)}),[i,a]),Object(r.useEffect)((function(){var e=_.filter((function(e){return+e.department_id==+N})).map((function(e){return+e.id})),t=N===h?x.filter((function(e){return new Date(+e.vacation_start).getFullYear()===+b&&new Date(+e.vacation_end).getFullYear()===+b})):x.filter((function(t){return-1!==e.indexOf(+t.user_id)&&new Date(+t.vacation_start).getFullYear()===+b&&new Date(+t.vacation_end).getFullYear()===+b}));M(t)}),[_,x,b,N]);return 0==x.length?o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Нет отпусков")):o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(De.a["page-title"])},"Список отпусков"),o.a.createElement("div",{className:Z()(De.a.wrap)},o.a.createElement("div",{className:Z()(De.a["wrap__add-vacation"])},o.a.createElement(p.b,{to:"vacation/new-vacation",className:Z()(De.a["button-new-object"],De.a[".button-new-object__text"])},"Добавить отпуск")),o.a.createElement("div",{className:Z()(De.a.wrap__manage)},o.a.createElement("div",{className:Z()(De.a.wrap__year)},o.a.createElement(oe,{identificate:"selectYear",title:"Выберите год",defaultValue:(new Date).getFullYear(),handleFunction:function(e){v(+e)},data:s})),o.a.createElement("div",{className:Z()(De.a.wrap__select)},o.a.createElement(oe,{identificate:"selectDepartmentInVacationList",title:"Выберите отдел",defaultValue:j[0].id,handleFunction:function(e){A(e)},data:j})))),o.a.createElement("div",null,0===k.length?o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Нет отпусков")):k.map((function(e,t){var n=_.length>0?_.find((function(t){return+e.user_id==+t.id})):{name:"Получение имени ...",surname:"Получение фамилии ..."},a="".concat(n.name," ").concat(n.surname);return o.a.createElement("div",{key:e.id,className:Z()(De.a["one-row"])},o.a.createElement("div",{className:Z()(De.a["one-row__number"])},o.a.createElement("span",null,"".concat(t+1,"."))),o.a.createElement("div",{className:Z()(De.a["one-row__name"],De.a["one-row__elem"])},o.a.createElement("span",null,a)),o.a.createElement("div",{className:Z()(De.a["one-row__dates"],De.a["one-row__elem"])},o.a.createElement("span",null,"".concat(new Date(e.vacation_start).getFullYear(),"-").concat(new Date(e.vacation_start).getMonth()+1,"-").concat(new Date(e.vacation_start).getDate(),"  :  ").concat(new Date(e.vacation_end).getFullYear(),"-").concat(new Date(e.vacation_end).getMonth()+1,"-").concat(new Date(e.vacation_end).getDate()))),o.a.createElement("div",{className:Z()(De.a["one-row__buttons"],De.a["one-row__elem"])},o.a.createElement(p.b,{to:"vacation/".concat(e.id),className:Z()(De.a["one-row__redaction"])},"Редактировать"),o.a.createElement("button",{onClick:function(){return function(e){console.log("delete",e);var t=x.filter((function(t){return+t.id!=+e}));F(t),R().set(t)}(e.id)},className:Z()(De.a["one-row__delete"])},"Удалить")))}))))},xe=n(51),Fe=n.n(xe);function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ke(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Me=function(e){var t=e.history,n=Object(r.useContext)(d),a=n.getVacationsRef,l=(n.getUsersRef,Ce(Object(r.useState)(e.match.params.id),2)),c=l[0],i=(l[1],Ce(Object(r.useState)([]),2)),u=i[0],s=i[1],m=Ce(Object(r.useState)([]),2),f=m[0],p=m[1],b=Ce(Object(r.useState)(0),2),v=b[0],g=b[1],_=Ce(Object(r.useState)(""),2),h=(_[0],_[1]),O=Ce(Object(r.useState)(0),2),j=O[0],S=O[1],D=Ce(Object(r.useState)(0),2),N=D[0],A=D[1],I=Ce(Object(r.useState)(0),2),x=I[0],F=I[1],C=Ce(Object(r.useState)(0),2),k=C[0],M=C[1],Y=Ce(Object(r.useState)(0),2),R=Y[0],T=Y[1],U=Object(r.useContext)(y),P=(U.login,U.userData),V=(U.allDepartmentsData,U.allUsersData),G=U.allVacationsData;Object(r.useEffect)((function(){if(+P.role_id===w||+P.role_id===E){var e=V.filter((function(e){return+e.id===P.id}));console.log(e),p(e)}else p(V)}),[V,P]),Object(r.useEffect)((function(){if(s(G),void 0!==c&&"new-vacation"!==c&&0!==c&&G.length>0&&f.length>0){console.log(G,f,c);var e=G.filter((function(e){return e.id===+c})),t=f.find((function(t){return+t.id==+e[0].user_id}));h("".concat(t.name," ").concat(t.surname));var n=e[0].vacation_start;M(n),A("".concat(new Date(n).getFullYear(),"-").concat(new Date(n).getMonth()+1>9?new Date(n).getMonth()+1:"0".concat(new Date(n).getMonth()+1),"-").concat(new Date(n).getDate()>9?new Date(n).getDate():"0".concat(new Date(n).getDate())));var a=e[0].vacation_end;T(a),F("".concat(new Date(a).getFullYear(),"-").concat(new Date(a).getMonth()+1>9?new Date(a).getMonth()+1:"0".concat(new Date(a).getMonth()+1),"-").concat(new Date(a).getDate()>9?new Date(a).getDate():"0".concat(new Date(a).getDate()))),S(e[0].id),g(+t.id)}else h("Имя нового отпускника"),S((new Date).getTime()),f[0]?g(f[0].id):g(0)}),[f,G]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Fe.a["page-title"])},"new-vacation"===c?"Новый отпуск":"Отпуск для пользователя"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=u.findIndex((function(e){return+e.id==+j}));-1!==n?(u[+n].user_id=v,u[+n].vacation_end=R,u[+n].vacation_start=k,0!==v&&0!==R&&0!==k?a().set(u).then((function(){return t.push("/vacations")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных")):(u.push({user_id:v,vacation_end:R,vacation_start:k,id:(new Date).getTime()}),0!==v&&0!==R&&0!==k?a().set(u).then((function(){return t.push("/vacations")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных"))},className:Z()(Fe.a.form)},o.a.createElement("div",{className:Z()(Fe.a["form-field"],Fe.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"user",className:Z()(Fe.a["select-label"])},"Пользователь:"),o.a.createElement("select",{id:"user",name:"user",value:+v,onChange:function(e){g(e.target.value)},className:Z()(Fe.a["select-element"])},f.map((function(e){var t="".concat(e.name," ").concat(e.surname);return o.a.createElement("option",{key:e.id,value:+e.id},t)})))),o.a.createElement("div",{className:Z()(Fe.a["form-field"],Fe.a["form-field__input-date-wrap"])},o.a.createElement("label",{htmlFor:"vacation_start",className:Z()(Fe.a["select-label"])},"Начало отпускного периода:"),o.a.createElement("input",{type:"date",id:"vacation_start",name:"vacation_start",value:N,onChange:function(e){A(e.target.value),M(e.target.valueAsNumber)},className:Z()(Fe.a["date-input"])})),o.a.createElement("div",{className:Z()(Fe.a["form-field"],Fe.a["form-field__input-date-wrap"])},o.a.createElement("label",{htmlFor:"vacation_end",className:Z()(Fe.a["select-label"])},"Конец отпускного периода:"),o.a.createElement("input",{type:"date",id:"vacation_end",name:"vacation_end",value:x,onChange:function(e){F(e.target.value),T(e.target.valueAsNumber)},className:Z()(Fe.a["date-input"])})),o.a.createElement("div",{className:Z()(Fe.a["form-field"])},o.a.createElement("button",{className:Z()(Fe.a["submit-button"])},"Отправить")))))},Ye=n(34),Re=n.n(Ye);function Te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Pe=function(e){var t=e.history,n=Object(r.useContext)(d),a=n.getRolesRef,l=n.getUsersRef,c=(n.getDepartmentsRef,Te(Object(r.useState)(e.match.params.id),2)),i=c[0],u=(c[1],Te(Object(r.useState)([]),2)),s=u[0],m=u[1],f=Te(Object(r.useState)(0),2),p=(f[0],f[1],Te(Object(r.useState)(""),2)),b=p[0],v=p[1],g=Te(Object(r.useState)(""),2),_=g[0],h=g[1],E=Te(Object(r.useState)(""),2),O=E[0],j=E[1],S=Te(Object(r.useState)([]),2),D=S[0],N=S[1],A=Te(Object(r.useState)(0),2),I=A[0],x=A[1],F=Te(Object(r.useState)([]),2),C=F[0],k=F[1],M=Te(Object(r.useState)(0),2),Y=M[0],R=M[1],T=Object(r.useContext)(y),U=(T.userData,T.allDepartmentsData),P=T.allUsersData;T.allVacationsData;Object(r.useEffect)((function(){a().once("value").then((function(e){return e.val()})).then((function(e){return N(e)})).catch((function(e){return console.log(e)})).finally((function(){return console.log("сходили за юзерами")}))}),[]),Object(r.useEffect)((function(){if(i&&s.length>0&&D.length>0)if("new-user"===i){var e=D.find((function(e){return+e.id===w}));x(+e.id)}else{var t=s.find((function(e){return+e.id==+i}));if(void 0!==t.role_id)x(+t.role_id);else{var n=D.find((function(e){return+e.id===w}));x(+n.id)}}}),[s,D]),Object(r.useEffect)((function(){m(P)}),[P]),Object(r.useEffect)((function(){var e=U.filter((function(e){return 99999!=+e.id&&"Все"!==e.name}));k(e)}),[U]),Object(r.useEffect)((function(){if(console.log(s,C,i),"new-user"!==i&&s.length>0&&void 0!==i){var e=s.find((function(e){return+e.id==+i}));v(e.name),h(e.surname),j(e.login),R(+e.department_id)}"new-user"===i&&C.length>0&&R(+C[0].id)}),[C,s]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:Z()(Re.a["page-title"])},"new-user"===i?"Новый пользователь":"Редактировать пользователя"),o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=s.findIndex((function(e){return+e.id==+i}));-1!==n?(s[+n].name=b,s[+n].surname=_,s[+n].login=O,s[+n].department_id=Y,s[+n].role_id=I,""!==b&&""!==_&&""!==O&&""!==Y?l().set(s).then((function(){return t.push("/users")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных")):(s.push({name:b,surname:_,login:O,id:(new Date).getTime(),department_id:Y,role_id:I}),""!==b&&""!==_&&""!==O&&""!==Y?l().set(s).then((function(){return t.push("/users")})).catch((function(e){return console.log(e)})):alert("Ошибка в данных"))},className:Z()(Re.a.form)},o.a.createElement("div",{className:Z()(Re.a["form-field"],Re.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"name",className:Z()(Re.a["select-label"])},"Имя:"),o.a.createElement("input",{type:"text",id:"name",name:"name",defaultValue:b,onChange:function(e){v(e.target.value)},className:Z()(Re.a["input-elem"])})),o.a.createElement("div",{className:Z()(Re.a["form-field"],Re.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"surname",className:Z()(Re.a["select-label"])},"Фамилия:"),o.a.createElement("input",{type:"text",id:"surname",name:"surname",defaultValue:_,onChange:function(e){h(e.target.value)},className:Z()(Re.a["input-elem"])})),o.a.createElement("div",{className:Z()(Re.a["form-field"],Re.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"login",className:Z()(Re.a["select-label"])},"Логин:"),o.a.createElement("input",{type:"text",id:"login",name:"login",defaultValue:O,onChange:function(e){j(e.target.value)},className:Z()(Re.a["input-elem"])})),o.a.createElement("div",{className:Z()(Re.a["form-field"],Re.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"departament",className:Z()(Re.a["select-label"])},"Отдел:"),o.a.createElement("select",{id:"departament",name:"departament",value:+Y,onChange:function(e){R(e.target.value)},className:Z()(Re.a["select-element"])},C.map((function(e){return o.a.createElement("option",{key:+e.id,value:+e.id},e.name)})))),o.a.createElement("div",{className:Z()(Re.a["form-field"],Re.a["form-field__select-wrap"])},o.a.createElement("label",{htmlFor:"roles",className:Z()(Re.a["select-label"])},"Набор прав:"),o.a.createElement(oe,{identificate:"roles",title:"Выберите набор прав",defaultValue:+I,handleFunction:function(e){x(+e)},data:D,className:Z()(Re.a["select-component"])})),o.a.createElement("div",{className:Z()(Re.a["form-field"])},o.a.createElement("button",{className:Z()(Re.a["submit-button"])},"Отправить")))))};function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Je=function(e){e.login;var t=e.userData,n=Ve(Object(r.useState)(+w),2),a=n[0],l=n[1];return Object(r.useEffect)((function(){t&&l(+t.role_id)}),[t]),o.a.createElement(i.d,null,o.a.createElement(i.b,{path:"/auth",render:function(e){return o.a.createElement(G,e)}}),a!==w?a!==E?o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{path:g.users.url,component:pe}),o.a.createElement(z,{path:g.user.url,component:Pe}),o.a.createElement(z,{path:g["new-user"].url,component:Pe}),o.a.createElement(z,{path:g.departments.url,component:_e}),o.a.createElement(z,{path:g.department.url,component:je}),o.a.createElement(z,{path:g["new-department"].url,component:je}),o.a.createElement(z,{path:g.vacations.url,component:Ie}),o.a.createElement(z,{path:g.vacation.url,component:Me}),o.a.createElement(z,{path:g["new-vacation"].url,component:Me}),o.a.createElement(z,{path:g.home.url,exact:!0,component:ue})):o.a.createElement(o.a.Fragment,null,o.a.createElement(z,{path:g.vacations.url,component:Ie}),o.a.createElement(z,{path:g.vacation.url,component:Me}),o.a.createElement(z,{path:g["new-vacation"].url,component:Me}),o.a.createElement(z,{path:g.home.url,exact:!0,component:ue})):o.a.createElement(z,{path:g.home.url,exact:!0,component:ue}),o.a.createElement(i.a,{to:"/"}))};function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ze(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Be=function(){var e=Object(r.useContext)(d),t=e.auth,n=e.getUsersRef,a=e.getDepartmentsRef,l=e.getVacationsRef,c=qe(Object(r.useState)(!0),2),i=c[0],u=c[1],s=qe(Object(r.useState)(!1),2),m=(s[0],s[1]),f=qe(Object(r.useState)(""),2),b=f[0],v=f[1],g=qe(Object(r.useState)(null),2),_=g[0],h=g[1],w=qe(Object(r.useState)([]),2),E=w[0],O=w[1],j=qe(Object(r.useState)([]),2),S=j[0],D=j[1],N=qe(Object(r.useState)([]),2),A=N[0],I=N[1];Object(r.useEffect)((function(){a().on("value",(function(e){O(e.val())}))}),[]),Object(r.useEffect)((function(){try{l().on("value",(function(e){D(e.val())}))}catch(e){console.log(e)}}),[]),Object(r.useEffect)((function(){localStorage.getItem("userId")?(console.log("we know who are you!"),t.onAuthStateChanged((function(e){u(!1),e?(m(e.uid),localStorage.setItem("userId",JSON.stringify(e.uid)),v(e.email),n().on("value",(function(t){var n=t.val();I(n);var a=n.find((function(t){return t.login===e.email}));h(a)}))):(m(!1),localStorage.removeItem("userId"))}))):(console.log("we don`t know who are you!"),m(!1),u(!1))}),[]);var x=Je({login:b,userData:_});return i?o.a.createElement(Y,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,null,o.a.createElement(y.Provider,{value:{login:b,userData:_,allDepartmentsData:E,allUsersData:A,allVacationsData:S}},x)))},Ze=(n(617),n(169));n(618),n(621);function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var We={apiKey:"AIzaSyCcY9SjOgc7yL6UihqaIq0wwlULYGIBnmM",authDomain:"vacations-app-9686b.firebaseapp.com",databaseURL:"https://vacations-app-9686b.firebaseio.com",projectId:"vacations-app-9686b",storageBucket:"vacations-app-9686b.appspot.com",messagingSenderId:"533684716413",appId:"1:533684716413:web:b66c494c733440e3b5c214"},Qe=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Le(this,"signWithEmail",(function(e,n){return t.auth.signInWithEmailAndPassword(e,n)})),Le(this,"getRolesRef",(function(){return t.database.ref("/roles/")})),Le(this,"getYearsRef",(function(){return t.database.ref("/years/")})),Le(this,"getDepartmentsRef",(function(){return t.database.ref("/departments/")})),Le(this,"getUsersRef",(function(){return t.database.ref("/users/")})),Le(this,"getVacationsRef",(function(){return t.database.ref("/vacations/")})),Le(this,"requestRef",(function(e){return t.database.ref(e)})),Ze.a.initializeApp(We),this.auth=Ze.a.auth(),this.database=Ze.a.database(),this.userUid=null};c.a.render(o.a.createElement(d.Provider,{value:new Qe},o.a.createElement(Be,null)),document.getElementById("root"))},87:function(e,t,n){e.exports={"content-title-block":"_3FNGMQ-zE50K4_ifpTiNmy","content-title-block__start-elem":"b36pquR0MFSJXNp-Muc9Z","content-title-block__elem":"_2-uWuAN1CGzVB5jO8LSwZm","page-title":"_1_UtturgCpyauKdEYtsVhx",wrap__manage:"_2JWJY8EB5vUDCsoeEmlpcb",wrap__select:"_5Rz1iDmOyhgHtaA6uVAOA",wrap__year:"_150dlS6aiBFL_J0KA0102k"}},88:function(e,t,n){e.exports={"page-title":"_2Lfe4Mtw8jkbQyA3josbay",form:"_3drwl5dPG9MNs31fnmBEvZ","form-field":"CnfZpkfu4LmDsUVWegHi_","form-field__select-wrap":"_3apSygjN4jJ5Sih86n8zTo","input-elem":"_2-OVDSQThvS-tZbjD1a68f","submit-button":"_1AaHCZVC1aEnBUPjaDF0kr"}}});